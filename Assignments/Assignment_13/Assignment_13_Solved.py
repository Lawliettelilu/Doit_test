# áƒ¨áƒ”áƒ¥áƒ›áƒ”áƒœáƒ˜áƒ— csv  áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ áƒáƒ›áƒ”áƒšáƒ¨áƒ˜áƒª áƒ’áƒ”áƒ¥áƒœáƒ”áƒ‘áƒáƒ— áƒ¨áƒ”áƒ›áƒ“áƒ”áƒ’áƒ˜ áƒ¡áƒ¢áƒ áƒ£áƒ¥áƒ¢áƒ£áƒ áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜:

# id,name,age,grade,subject_name,mark
# 1,string,0,string,string,0
# 2,string,0,string,string,0

import os, csv

# 1. áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒáƒ˜áƒ—áƒáƒœáƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ, áƒ¡áƒáƒ“áƒáƒª áƒ›áƒáƒ›áƒ®áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ¡ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒáƒ¡(id,name,age,grade,subject_name,mark)
#  áƒ“áƒ áƒ—áƒ¥áƒ•áƒ”áƒœ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ¡ áƒ“áƒáƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ¡ csv áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜. áƒ“áƒáƒáƒ¡áƒáƒ áƒ¢áƒ˜áƒ áƒ”áƒ— áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ id-áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—.


# áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜
filename = "students.csv"

def add_student():
    # áƒ—áƒ£ áƒ¤áƒáƒ˜áƒšáƒ˜ áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡, áƒ•áƒ¥áƒ›áƒœáƒ˜áƒ— áƒ“áƒ áƒ•áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ— áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ”áƒ‘áƒ¡
    if not os.path.exists(filename):
        with open(filename, "w", newline="", encoding="utf-8") as file:
            writer = csv.writer(file)
            writer.writerow(["id", "name", "age", "grade", "subject_name", "mark"])

    # áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡áƒ’áƒáƒœ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ¦áƒ”áƒ‘áƒ
    id_ = int(input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” ID: "))
    name = input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¡áƒáƒ®áƒ”áƒšáƒ˜: ")
    age = int(input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒáƒ¡áƒáƒ™áƒ˜: "))
    grade = input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ™áƒšáƒáƒ¡áƒ˜/áƒ™áƒ£áƒ áƒ¡áƒ˜: ")
    subject = input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¡áƒáƒ’áƒáƒœáƒ˜: ")
    mark = float(input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¥áƒ£áƒšáƒ: "))

    # áƒáƒ®áƒáƒšáƒ˜ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ©áƒáƒ¬áƒ”áƒ áƒ áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜
    with open(filename, "a", newline="", encoding="utf-8") as file:
        writer = csv.writer(file)
        writer.writerow([id_, name, age, grade, subject, mark])

    # áƒ¡áƒáƒ áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ ID-áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—
    sort_by_id()


def sort_by_id():
    # áƒ§áƒ•áƒ”áƒšáƒ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ
    with open(filename, "r", encoding="utf-8") as file:
        reader = list(csv.reader(file))
        header = reader[0]
        data = reader[1:]

    # áƒ¡áƒáƒ áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ ID-áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—
    data.sort(key=lambda x: int(x[0]))

    # áƒ®áƒ”áƒšáƒáƒ®áƒšáƒ áƒ©áƒáƒ¬áƒ”áƒ áƒ
    with open(filename, "w", newline="", encoding="utf-8") as file:
        writer = csv.writer(file)
        writer.writerow(header)
        writer.writerows(data)

    print("áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒ“áƒáƒ”áƒ›áƒáƒ¢áƒ áƒ“áƒ áƒ“áƒáƒáƒšáƒáƒ’áƒ“áƒ ID-áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—!")

    

# 2. áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒáƒ˜áƒ—áƒáƒœáƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ, áƒ áƒáƒ›áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒšáƒ”áƒ‘áƒ˜áƒ— áƒ›áƒáƒ›áƒ®áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ¡ áƒ¨áƒ”áƒ”áƒ«áƒšáƒ”áƒ‘áƒ,
# áƒ áƒáƒ’áƒáƒ áƒª áƒ§áƒ•áƒ”áƒšáƒ, áƒáƒ¡áƒ”áƒ•áƒ” áƒ™áƒáƒœáƒ™áƒ áƒ”áƒ¢áƒ£áƒšáƒ˜ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ áƒ¤áƒáƒ˜áƒšáƒ˜áƒ“áƒáƒœ.

def read_students():
    if not os.path.exists(filename):
        print(" áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡.")
        return

    choice = input("áƒ’áƒ˜áƒœáƒ“áƒ áƒ§áƒ•áƒ”áƒšáƒ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒœáƒáƒ®áƒ•áƒ (A) áƒ—áƒ£ áƒ™áƒáƒœáƒ™áƒ áƒ”áƒ¢áƒ£áƒšáƒ˜áƒ¡ (S)? ").strip().lower()

    with open(filename, "r", encoding="utf-8") as file:
        reader = csv.DictReader(file)
        students = list(reader)

    if choice == 'a':
        print("\n áƒ§áƒ•áƒ”áƒšáƒ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜:\n")
        for s in students:
            print(f"ID: {s['id']}, áƒ¡áƒáƒ®áƒ”áƒšáƒ˜: {s['name']}, áƒáƒ¡áƒáƒ™áƒ˜: {s['age']}, áƒ™áƒšáƒáƒ¡áƒ˜: {s['grade']}, áƒ¡áƒáƒ’áƒáƒœáƒ˜: {s['subject_name']}, áƒ¥áƒ£áƒšáƒ: {s['mark']}")
    elif choice == 's':
        search_id = input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ ID: ")
        found = False
        for s in students:
            if s["id"] == search_id:
                print(f"\nğŸ“ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ:\n"
                      f"ID: {s['id']}\n"
                      f"áƒ¡áƒáƒ®áƒ”áƒšáƒ˜: {s['name']}\n"
                      f"áƒáƒ¡áƒáƒ™áƒ˜: {s['age']}\n"
                      f"áƒ™áƒšáƒáƒ¡áƒ˜: {s['grade']}\n"
                      f"áƒ¡áƒáƒ’áƒáƒœáƒ˜: {s['subject_name']}\n"
                      f"áƒ¥áƒ£áƒšáƒ: {s['mark']}")
                found = True
                break
        if not found:
            print(" áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜ áƒáƒ› ID-áƒ˜áƒ— áƒ•áƒ”áƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ.")
    else:
        print(" áƒáƒ áƒáƒ¡áƒ¬áƒáƒ áƒ˜ áƒáƒ áƒ©áƒ”áƒ•áƒáƒœáƒ˜!")


# 3. áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒáƒ˜áƒ—áƒáƒœáƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ“áƒáƒ˜áƒ—áƒ•áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ áƒ¥áƒ£áƒšáƒáƒ¡ (mark) áƒ¡áƒáƒ’áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—.

def average_marks_by_subject():
    if not os.path.exists(filename):
        print(" áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡.")
        return

    subjects = {}  

    with open(filename, "r", encoding="utf-8") as file:
        reader = csv.DictReader(file)
        for row in reader:
            subject = row["subject_name"]
            mark = float(row["mark"])

            # áƒ—áƒ£ áƒ¡áƒáƒ’áƒáƒœáƒ˜ áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡ áƒšáƒ”áƒ¥áƒ¡áƒ˜áƒ™áƒáƒœáƒ¨áƒ˜, áƒ•áƒ¥áƒ›áƒœáƒ˜áƒ— áƒáƒ®áƒáƒš áƒ¡áƒ˜áƒáƒ¡
            if subject not in subjects:
                subjects[subject] = []
            subjects[subject].append(mark)

    if not subjects:
        print(" áƒ¤áƒáƒ˜áƒšáƒ˜ áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜áƒ.")
        return

    print("\n áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ áƒ¥áƒ£áƒšáƒ”áƒ‘áƒ˜ áƒ¡áƒáƒ’áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—:\n")
    for subject, marks in subjects.items():
        avg = sum(marks) / len(marks)
        print(f"{subject}: {avg:.2f}")

    print("\n áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ áƒ“áƒáƒ¡áƒ áƒ£áƒšáƒ“áƒ!")



# 4. áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒáƒ˜áƒ—áƒáƒœáƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ, áƒ áƒáƒ›áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒ˜áƒ— áƒ¨áƒ”áƒ¡áƒáƒ«áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ˜áƒ¥áƒœáƒ”áƒ‘áƒ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ¥áƒ£áƒšáƒ˜áƒ¡ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ/áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ.
# áƒ›áƒáƒ›áƒ®áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ¡ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ id, áƒ¡áƒáƒ’áƒáƒœáƒ¡ áƒ“áƒ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ£áƒš áƒ¥áƒ£áƒšáƒáƒ¡.

def update_student_mark():
    if not os.path.exists(filename):
        print(" áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡.")
        return

    student_id = input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ ID: ").strip()
    subject = input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒ¡áƒáƒ’áƒœáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜: ").strip()
    new_mark = float(input("áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ” áƒáƒ®áƒáƒšáƒ˜ áƒ¥áƒ£áƒšáƒ: "))

    updated = False

    # áƒ§áƒ•áƒ”áƒšáƒ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ
    with open(filename, "r", encoding="utf-8") as file:
        reader = list(csv.DictReader(file))
        fieldnames = reader[0].keys() if reader else []

    # áƒ¥áƒ£áƒšáƒ˜áƒ¡ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ¡áƒ áƒ“áƒ áƒ¡áƒáƒ’áƒáƒœáƒ¨áƒ˜
    for row in reader:
        if row["id"] == student_id and row["subject_name"].lower() == subject.lower():
            row["mark"] = str(new_mark)
            updated = True
            break

    # áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ˜áƒ¡ áƒ©áƒáƒ¬áƒ”áƒ áƒ áƒ˜áƒ¡áƒ”áƒ• áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜
    if updated:
        with open(filename, "w", newline="", encoding="utf-8") as file:
            writer = csv.DictWriter(file, fieldnames=fieldnames)
            writer.writeheader()
            writer.writerows(reader)
        print(f" áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜áƒ¡ (ID: {student_id}) áƒ¥áƒ£áƒšáƒ áƒ¡áƒáƒ’áƒáƒœáƒ¨áƒ˜ '{subject}' áƒ’áƒáƒœáƒáƒ®áƒšáƒ“áƒ {new_mark}-áƒ–áƒ”.")
    else:
        print(" áƒ•áƒ”áƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ áƒ¡áƒ¢áƒ£áƒ“áƒ”áƒœáƒ¢áƒ˜ áƒáƒ› ID-áƒ˜áƒ— áƒáƒœ áƒ¡áƒáƒ’áƒœáƒ˜áƒ—.")

